<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Hardly Print Editor</title>
        <!-- <link rel="stylesheet" href="./css/workflow.css"> -->
        <link rel="stylesheet" href="./css/monaco.css" />
        <link rel="stylesheet" href="./css/xterm.css" />
        <link rel="stylesheet" href="./css/main.css" />
        <link rel="stylesheet" href="./css/litegraph.css" />
        <link rel="stylesheet" href="./css/ui.css" />
        <link rel="stylesheet" href="./css/titlebar.css" />
        <script src="./js/lib/xterm.js"></script>
        <script src="./js/lib/addon-fit.js"></script>
        <script src="./js/lib/addon-attach.js"></script>
        <script src="./js/lib/litegraph.core.min.js"></script>
        <script src="./js/vs/loader.js"></script>
        <script type="module" src="./js/tauri.js"></script>
    </head>

    <body style="background-color: transparent; width: 100vh; height: 100vh;">
        <div class="titlebar" data-tauri-drag-region>
            <div class="controls">
                <button id="titlebar-minimize">-</button>
                <button id="titlebar-maximize">f</button>
                <button id="titlebar-close">x</button>
            </div>
        </div>
        <div class="container">
            <div class="canvas-container">
                <canvas id="workflowCanvas"></canvas>
            </div>
        </div>

        <div id="editor-container">
            <nav id="main-editor-navs" class="navs">
                <button onclick="switchSection('files')" class="nav-button" id="files-btn" title="Files">../</button>
                <button onclick="switchSection('terminal')" class="nav-button" id="terminal-btn" title="Terminal">>_</button>
                <button onclick="switchSection('node')" class="nav-button" id="node-editor-btn" title="Editor">{&nbsp&nbsp}</button>
                <button onclick="switchSection('code')" class="nav-button active" id="code-editor-btn" title="Editor">f(x)</button>
            </nav>
            <section class="multi-editors activePage">
                <div id="main-editor" class="editor"></div>
            </section>
            <section id="terminal"></section>
            <section id="files"></section>
        </div>

        <script src="./js/main.js"></script>
        <script src="./js/ui.js"></script>
        <script src="./js/monaco.js"></script>
        <script src="./js/workflow.js"></script>
        <script src="./js/derivedNodes.js"></script>
        <script src="./js/nodes.js"></script>
        <script src="./js/autoResize.js"></script>
        <script src="./js/invoke.js"></script>
        <script src="./js/terminal.js"></script>
        <script>
            const canvasManager = new AdaptiveCanvasManager("workflowCanvas");

            initializeDefaultNodes();

            // 创建LiteGraph实例
            setTimeout(() => {
                window.graph = new LGraph();
                window.canvas = new LGraphCanvas(
                    "#workflowCanvas",
                    window.graph,
                );
            }, 10);
        </script>
        <!-- 小土星悬浮菜单球 -->
        <link rel="stylesheet" href="./css/floatball.css" />
        <div class="saturn-menu-container">
            <div class="saturn-ring-lower saturn-ring"></div>
            <div class="saturn-ring-upper saturn-ring"></div>
            <div class="saturn-ball">
                <div class="glow"></div>
                <nav class="icon-item" id="setting">
                    <svg width="30" height="30" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.9 12.66a1 1 0 0 1 0-1.32l1.28-1.44a1 1 0 0 0 .12-1.17l-2-3.46a1 1 0 0 0-1.07-.48l-1.88.38a1 1 0 0 1-1.15-.66l-.61-1.83a1 1 0 0 0-.95-.68h-4a1 1 0 0 0-1 .68l-.56 1.83a1 1 0 0 1-1.15.66L5 4.79a1 1 0 0 0-1 .48L2 8.73a1 1 0 0 0 .1 1.17l1.27 1.44a1 1 0 0 1 0 1.32L2.1 14.1a1 1 0 0 0-.1 1.17l2 3.46a1 1 0 0 0 1.07.48l1.88-.38a1 1 0 0 1 1.15.66l.61 1.83a1 1 0 0 0 1 .68h4a1 1 0 0 0 .95-.68l.61-1.83a1 1 0 0 1 1.15-.66l1.88.38a1 1 0 0 0 1.07-.48l2-3.46a1 1 0 0 0-.12-1.17ZM18.41 14l.8.9-1.28 2.22-1.18-.24a3 3 0 0 0-3.45 2L12.92 20h-2.56L10 18.86a3 3 0 0 0-3.45-2l-1.18.24-1.3-2.21.8-.9a3 3 0 0 0 0-4l-.8-.9 1.28-2.2 1.18.24a3 3 0 0 0 3.45-2L10.36 4h2.56l.38 1.14a3 3 0 0 0 3.45 2l1.18-.24 1.28 2.22-.8.9a3 3 0 0 0 0 3.98m-6.77-6a4 4 0 1 0 4 4 4 4 0 0 0-4-4m0 6a2 2 0 1 1 2-2 2 2 0 0 1-2 2"/></svg>
                </nav>
                <nav class="icon-item" id="save" tabindex="0" role="button">
                    <svg width="30" height="30" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M14 9.004a1 1 0 0 1 1 1v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-3a1 1 0 0 1 2 0v3h10v-3a1 1 0 0 1 1-1M8 1.59l3.707 3.707a1 1 0 0 1-1.414 1.414L9 5.418v4.586a1 1 0 1 1-2 0V5.418L5.707 6.711a1 1 0 0 1-1.414-1.414z"/></svg>
                </nav>
                <nav class="icon-item" id="import" tabindex="0" role="button">
                    <svg width="30" height="30" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M14 9a1 1 0 0 1 1 1v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-3a1 1 0 0 1 2 0v3h10v-3a1 1 0 0 1 1-1M8 1a1 1 0 0 1 1 1v4.586l1.293-1.293a1 1 0 1 1 1.414 1.414L8 10.414 4.293 6.707a1 1 0 0 1 1.414-1.414L7 6.586V2a1 1 0 0 1 1-1"/></svg>
                </nav>
            </div>
        </div>
        <script src="./js/floatball.js"></script>

        <link rel="stylesheet" href="./css/debugToolbar.css" />
        <div class="debug-toolbar" id="debugToolbar">
            <div class="debug-button" id="btnNext" title="Next">
                <svg width="25" height="25" viewBox="0 0 24 24" data-name="Flat Color" xmlns="http://www.w3.org/2000/svg" class="icon flat-color"><path d="m18.6 11.2-12-9A1 1 0 0 0 5 3v18a1 1 0 0 0 .55.89 1 1 0 0 0 1-.09l12-9a1 1 0 0 0 0-1.6Z"/></svg>
                <span class="button-text">Next (F1 / n)</span>
            </div>

            <div class="debug-button" id="btnRun" title="Run">
                <svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 51.531 51.531" xml:space="preserve"><path d="M44.9 1.963a6.63 6.63 0 0 0-6.631 6.631V23.81a4 4 0 0 0-1-.831L6 4.926A3.998 3.998 0 0 0 0 8.39v36.104a4.002 4.002 0 0 0 6 3.465l31.269-18.053a4 4 0 0 0 1-.832v13.863a6.631 6.631 0 0 0 13.262 0V8.594A6.63 6.63 0 0 0 44.9 1.963"/></svg>
                <span class="button-text">Run (r)</span>
            </div>
            <div class="debug-button active" id="btnStop" style="display: none;" title="停止调试">
                <svg width="20" height="20" viewBox="0 0 24 24" data-name="Flat Color" xmlns="http://www.w3.org/2000/svg" class="icon flat-color"><rect x="2" y="2" width="20" height="20" rx="2"/></svg>
                <span class="button-text">Stop (r)</span>
            </div>

            <div class="debug-button" id="btnRetrun" title="Return">
                <svg width="30" height="30" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.75 8a4.5 4.5 0 0 1-8.61 1.834l-1.391.565A6.001 6.001 0 0 0 14.25 8 6 6 0 0 0 3.5 4.334V2.5H2v4l.75.75h3.5v-1.5H4.352A4.5 4.5 0 0 1 12.75 8"/></svg>
                <span class="button-text">Return (Alt + 4)</span>
            </div>

            <div class="debug-button" id="btnToggleBreakpoint" title="Breakpoint">
                <svg width="30" height="30" viewBox="0 -15.89 87.181 87.181" xmlns="http://www.w3.org/2000/svg"><g data-name="Group 18" transform="translate(-355.391 -272.962)"><circle data-name="Ellipse 4" cx="4.92" cy="4.92" r="4.92" transform="rotate(-45 525.115 -285.089)"/></g><g data-name="Group 19"><path data-name="Path 18" d="M86.888 14.39C84.627 7.3 71.127 7.91 65.157 8.54a27.744 27.744 0 0 0-47.44 15.14c-5.24 2.94-16.6 10.25-14.34 17.34 1.62 5.08 8.98 6.2 15.22 6.2a60 60 0 0 0 6.51-.37 27.7 27.7 0 0 0 47.42-15.11c5.23-2.93 16.621-10.26 14.361-17.35M8.617 39.35c-.529-1.64 3.5-5.62 8.93-9.14a27.9 27.9 0 0 0 3.64 11.42c-6.46.29-12.039-.63-12.57-2.28m43.26 9.5a22.17 22.17 0 0 1-19.63-3.05 136.5 136.5 0 0 0 33.82-10.77 22.17 22.17 0 0 1-14.19 13.82m-4.01-12.58a134 134 0 0 1-20.5 4.76 22.3 22.3 0 0 1-3.38-6.58 22.183 22.183 0 0 1 14.4-27.89 22.17 22.17 0 0 1 23.45 6.5 2.3 2.3 0 0 1 .24.29l.039.04a22.3 22.3 0 0 1 5.2 14.91 136 136 0 0 1-19.449 7.97m24.85-11.07a26.8 26.8 0 0 0-1.19-5.91 27.3 27.3 0 0 0-2.439-5.51c6.449-.28 12.029.63 12.56 2.28s-3.491 5.62-8.931 9.14"/></g><g data-name="Group 20" transform="translate(-355.391 -272.962)"/><g data-name="Group 21"><path data-name="Path 20" d="M60.72 26.419a2.75 2.75 0 0 1-2.59-1.825 15.3 15.3 0 0 0-4.807-6.7 2.75 2.75 0 0 1 3.463-4.274 20.8 20.8 0 0 1 6.523 9.118 2.752 2.752 0 0 1-2.59 3.677Z"/></g><g data-name="Group 22"><path data-name="Path 21" d="M47.521 14.851a2.8 2.8 0 0 1-.6-.066 15 15 0 0 0-1.972-.307A2.75 2.75 0 1 1 45.443 9a21 21 0 0 1 2.676.417 2.75 2.75 0 0 1-.6 5.434Z"/></g></svg>
                <span class="button-text">Breakpoint (F3 / d)</span>
            </div>

            <div class="status-indicator status-running">
                <div class="status-dot"></div>
                <span>Running</span>
            </div>
        </div>
        <script src="./js/debugToolbar.js"></script>
    </body>
</html>
